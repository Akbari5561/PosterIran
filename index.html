<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูพูุณุชุฑ ุงุฑุงู | ูุฑูุดฺฏุงู ูพูุณุชุฑูุง ุขููุฒุด</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Vazirmatn', sans-serif; scroll-behavior: smooth; }
        .hero-gradient { background: linear-gradient(135deg, #0d2440 0%, #1e40af 100%); }
        .image-box { transition: transform 0.3s ease; }
        .image-box:hover { transform: translateY(-5px); }
        .hidden-section { display: none; }
        .qty-select { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
        
        /* ุงุณุชุงู ุงุนูุงู (Toast) */
        /* ุงุณุชุงู ุฌุฏุฏ ู ููุงูโุชุฑ ุจุฑุง ุงุนูุงู */
#toast {
    transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    top: 20px; /* ูุฑุงุฑฺฏุฑ ุฏุฑ ุจุงูุง ุตูุญู */
}
.qty-container {
    position: relative;
    display: flex;
    items-center: center;
    gap: 0.75rem;
    background: white;
    padding: 0.3rem 0.75rem;
    border-radius: 0.75rem;
    border: 2px solid #e0e7ff; /* blue-100 */
}
/* ุจุงฺฉุณ ุงุตู ฺฉูุชุฑู ุชุนุฏุงุฏ ุฏุฑ ุณุจุฏ ุฎุฑุฏ */
.qty-container-mini {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    width: 100px;
    height: 32px;
    overflow: hidden;
}

/* ุฏุฑุงูพโุฏุงู ฺฉุงููุงู ูุฎู ฺฉู ููุท ุฑู ุนุฏุฏ ุนูู ูโฺฉูุฏ */
.qty-select-overlay {
    position: absolute;
    left: 33.33%;
    width: 33.33%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
    z-index: 10;
}

.qty-btn {
    width: 32px;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #2563eb;
    transition: background 0.2s;
}

.qty-btn:hover { background: #eff6ff; }
/* ูุถุนุช ูพููุงู (ุฎุงุฑุฌ ุงุฒ ุตูุญู ุฏุฑ ุจุงูุง) */
.toast-hidden {
    opacity: 0 !important;
    transform: translate(-50%, -100px) scale(0.9) !important;
    pointer-events: none;
}

/* ูุถุนุช ููุงุงู (ูุบุฒุด ุจู ูพุงู) */
.toast-visible {
    opacity: 1 !important;
    transform: translate(-50%, 20px) scale(1) !important;
}
    </style>
</head>
<body class="bg-gray-50 text-gray-900 pb-20">

    <div id="toast" class="fixed top-0 left-1/2 -translate-x-1/2 z-[1000] px-6 py-3 rounded-2xl flex flex-col items-center gap-1 border border-white/40 bg-white/80 text-blue-900 shadow-xl toast-hidden">
    <div class="flex items-center gap-3">
        <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white shadow-sm">
            <i class="fas fa-check text-[10px]"></i>
        </div>
        <span id="toastText" class="font-bold text-xs">ุขุชู ุงุถุงูู ุดุฏ</span>
    </div>
    <span id="toastGroup" class="text-[10px] text-blue-600 opacity-80"></span>
</div>
    <header class="fixed w-full z-50 bg-white/90 backdrop-blur-md border-b border-gray-200 shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="showScreen('home')">
                <img src="https://akbari5561.github.io/PosterIran/icons/logo.png" alt="Logo" class="h-10 w-10">
                <span class="text-xl font-bold text-blue-900">ูพูุณุชุฑ ุงุฑุงู</span>
            </div>
            <nav class="hidden md:flex gap-8 font-medium">
                <a href="#benefits" class="hover:text-blue-600 transition">ูุฒุงุง</a>
                <a href="#products" class="hover:text-blue-600 transition">ูุญุตููุงุช</a>
                <a href="#faq" class="hover:text-blue-600 transition">ุณูุงูุงุช ูุชุฏุงูู</a>
            </nav>
            <div class="flex gap-4">
                <button onclick="showScreen('cart')" class="relative bg-blue-100 text-blue-800 p-2 rounded-full hover:bg-blue-200 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <span class="cartBadge absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full hidden">0</span>
                </button>
            </div>
        </div>
    </header>

    <main class="pt-20">
        <section id="homeScreen">
            <div id="resumeOrder" class="hidden bg-yellow-400/20 border border-yellow-500 p-3 rounded-2xl mb-6 flex items-center justify-between animate-bounce">
    <span class="text-sm font-bold text-yellow-900">โ๏ธ ุดูุง ฺฉ ุณูุงุฑุด ุชฺฉูู ูุดุฏู ุฏุงุฑุฏ!</span>
    <button onclick="showScreen('cart')" class="bg-yellow-500 text-white px-3 py-1 rounded-lg text-xs">ุงุฏุงูู ุฎุฑุฏ</button>
</div>
            <div class="hero-gradient text-white py-20 px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight">
    ุงุฏฺฏุฑ ุฑุง ุจู ฺฉ <span class="text-yellow-400">ูุงุฌุฑุงุฌู ุจุตุฑ</span> ุชุจุฏู ฺฉูุฏ!
</h1>
                <p class="text-lg md:text-xl mb-10 text-blue-100 leading-relaxed">
    ูุฌููุนูโุง ุงุฒ ูพูุณุชุฑูุง ุขููุฒุด ุญุฑููโุงุ ููฺฏุงู ุจุง ฺฉุชุจ ุฏุฑุณุ ุทุฑุงุญ ุดุฏู ุจุฑุง ูุนููุงู ุฎูุงู ู ุฏุงูุดโุขููุฒุงู ฺฉู ุจู ุฏูุจุงู ุงุฏฺฏุฑ ุนููโุชุฑ ูุณุชูุฏ.
</p>

                <div class="flex flex-col md:flex-row gap-4 justify-center">
                    <button onclick="showScreen('gallery')" class="bg-yellow-500 text-blue-900 px-10 py-4 rounded-xl text-xl font-bold hover:bg-yellow-400 transition transform hover:scale-105 shadow-2xl">ูุดุงูุฏู ฺฏุงูุฑ ูุญุตููุงุช</button>
                    <div id="pendingOrderNotice" class="hidden mt-6 mx-4 p-4 bg-yellow-50 border-2 border-yellow-400 rounded-2xl flex items-center justify-between animate-pulse">
    <div class="flex items-center gap-3">
        <span class="text-2xl">๐</span>
        <div>
            <p class="font-bold text-yellow-800 text-sm">ุดูุง ฺฉ ุณุจุฏ ุฎุฑุฏ ูุงุชูุงู ุฏุงุฑุฏ!</p>
            <p class="text-xs text-yellow-700">ุงููุงู ูุจู ูููุฒ ุฏุฑ ุณุจุฏ ุดูุง ููุฌูุฏ ุงุณุช.</p>
        </div>
    </div>
    <button onclick="showScreen('cart')" class="bg-yellow-500 text-white px-4 py-2 rounded-xl font-bold text-xs shadow-md">ูุดุงูุฏู ุณุจุฏ</button>
</div>
                    <a href="#benefits" class="border-2 border-white/30 bg-white/10 px-10 py-4 rounded-xl text-xl font-bold hover:bg-white/20 transition">ฺุฑุง ูพูุณุชุฑ ุขููุฒุดุ</a>
                </div>
            </div>
            
            <div id="benefits" class="py-20 container mx-auto px-4">
                <div class="text-center mb-16">
                    <h2 class="text-3xl font-bold text-gray-800 mb-4">ฺุฑุง ูุญุทโูุง ุขููุฒุด ุจู ูพูุณุชุฑูุง ูุง ูุงุฒ ุฏุงุฑูุฏุ</h2>
                    <p class="text-gray-600">ูุฑุงุชุฑ ุงุฒ ฺฉ ุฏฺฉูุฑุงุณูู ุณุงุฏูุ ูุง ุงุจุฒุงุฑ ุงุฏฺฏุฑ ูโุณุงุฒู.</p>
                </div>
                <div class="grid md:grid-cols-3 gap-10">
                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 text-center">
                        <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-4 text-blue-900">ุงูุฒุงุด ตฐ ุฏุฑุตุฏ ุชูุฑฺฉุฒ</h3>
                        <p class="text-gray-600">ุชุญููุงุช ูุดุงู ุฏุงุฏู ฺฉู ุงุฏฺฏุฑ ุจุตุฑ ูุงูุฏฺฏุงุฑ ูุทุงูุจ ุฑุง ุฏุฑ ุฐูู ุฏุงูุดโุขููุฒุงู ุชุง ฺูุฏู ุจุฑุงุจุฑ ุงูุฒุงุด ูโุฏูุฏ.</p>
                    </div>
                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 text-center">
                        <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-4 text-green-900">ูุทุงุจู ุจุง ุงุณุชุงูุฏุงุฑุฏูุง ุขููุฒุด</h3>
                        <p class="text-gray-600">ุชูุงู ูุญุชูุงูุง ุจุฑ ุงุณุงุณ ุขุฎุฑู ุชุบุฑุงุช ฺฉุชุจ ุฏุฑุณ ุทุฑุงุญ ุดุฏู ู ููุฑุฏ ุชุงุฏ ูุฏุฑุณุงู ุจุฑุชุฑ ุงุณุช.</p>
                    </div>
                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100 text-center">
                        <div class="bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                            <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-4 text-purple-900">ุฏูุงู ู ูุงูุฏฺฏุงุฑ ุจุงูุง</h3>
                        <p class="text-gray-600">ุงุณุชูุงุฏู ุงุฒ ูพูุดุดโูุง UV ู ฺฉุงุบุฐูุง ุจุงฺฉูุช ฺฉู ุฏุฑ ุจุฑุงุจุฑ ููุฑ ู ุฑุทูุจุช ฺฉูุงุณ ุฏุฑุณ ููุงูู ูุณุชูุฏ.</p>
                    </div>
                </div>
            </div>
        </section>
        <section id="faq" class="py-20 container mx-auto px-6 max-w-3xl">
        <h2 class="text-3xl font-bold text-center mb-12">ุณูุงูุงุช ูุชุฏุงูู</h2>
        <div class="space-y-4">
            <details class="group bg-white rounded-xl p-6 border border-gray-200">
                <summary class="font-bold cursor-pointer list-none flex justify-between items-center text-blue-900">
                    ฺฺฏููู ูโุชูุงูู ุณูุงุฑุด ุฎูุฏ ุฑุง ุซุจุช ฺฉููุ
                    <span class="group-open:rotate-180 transition">โ</span>
                </summary>
                <p class="mt-4 text-gray-600 leading-relaxed">
                    ุดูุง ูโุชูุงูุฏ ุงุฒ ุทุฑู ูุฑูุฏ ุจู ฺฏุงูุฑ ู ุงูุชุฎุงุจ ูุญุตููุงุชุ ุณูุงุฑุด ุฎูุฏ ุฑุง ุจู ุตูุฑุช ูุณุชูู ุฏุฑ ูุงุชุณโุขูพ ุง ุงุชุง ุจุฑุง ฺฉุงุฑุดูุงุณุงู ูุง ุงุฑุณุงู ฺฉูุฏ.
                </p>
            </details>
            <details class="group bg-white rounded-xl p-6 border border-gray-200">
                <summary class="font-bold cursor-pointer list-none flex justify-between items-center text-blue-900">
                    ุขุง ุงุฑุณุงู ุจู ุดูุฑุณุชุงู ุฏุงุฑุฏุ
                    <span class="group-open:rotate-180 transition">โ</span>
                </summary>
                <p class="mt-4 text-gray-600 leading-relaxed">
                    ุจููุ ูพูุณุชุฑ ุงุฑุงู ูุญุตููุงุช ุฎูุฏ ุฑุง ุงุฒ ุทุฑู ูพุณุช ู ุจุงุฑุจุฑ ุจู ุชูุงู ููุงุท ฺฉุดูุฑ ุงุฑุณุงู ูโฺฉูุฏ.
                </p>
            </details>
        </div>
    </section>

        <section id="galleryScreen" class="hidden-section container mx-auto px-4 py-10">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 bg-blue-50 p-6 rounded-2xl">
                <div>
                    <h2 class="text-3xl font-bold text-blue-900">ฺฏุงูุฑ ูุญุตููุงุช</h2>
                    <p class="text-gray-500">ุณุงุฒ ููุฑุฏ ูุธุฑ ุฑุง ุงูุชุฎุงุจ ู ุชุนุฏุงุฏ ูุฑ ูุญุตูู ุฑุง ุชุนู ฺฉูุฏ.</p>
                </div>
                <select id="groupSelect" onchange="loadImages()" class="w-full md:w-72 p-4 rounded-2xl border-2 border-slate-100 bg-white font-bold text-blue-800 outline-none">
                    <option value="1">ุณุงุฒ ฒนรฒฑ ุฏูุฑูฺุงูพ</option>
                    <option value="3">ุณุงุฒ ตฐรณต ุฏูุฑูฺุงูพ</option>
                    <option value="4">ุณุงุฒ ทฐรตฐ ฺฉุฑูฺุงูพ</option>
                    <option value="5">ุณุงุฒ ทฐรตฐ ููโุฏุงุฑ</option>
                    <option value="6">ุณุงุฑ ูุญุตููุงุช</option>
                </select>
            </div>
            <div id="imagesContainer" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6 mb-10"></div>
        </section>

        <section id="cartScreen" class="hidden-section container mx-auto px-4 py-10 max-w-4xl">
            <div class="bg-white rounded-3xl shadow-xl p-6 md:p-10 border border-gray-100">
                <div class="flex items-center gap-3 mb-8 border-b pb-4">
                    <h2 class="text-3xl font-bold text-gray-800">๐ ุณุจุฏ ุฎุฑุฏ ุดูุง</h2>
                </div>
                <div id="cartList" class="space-y-4 mb-8"></div>
                <div class="bg-blue-50 p-6 rounded-2xl mb-8 flex justify-between items-center">
                    <span class="text-xl font-bold text-blue-900">ูุจูุบ ูุงุจู ูพุฑุฏุงุฎุช:</span>
                    <span id="totalPrice" class="text-2xl font-black text-blue-700">ฐ ุฑุงู</span>
                </div>
                <div class="space-y-4 bg-gray-50 p-6 rounded-2xl">
    <input type="text" id="customerName" oninput="saveCustomerData()" placeholder="ูุงู ู ูุงู ุฎุงููุงุฏฺฏ" class="w-full p-4 rounded-xl border outline-none focus:ring-2 focus:ring-blue-500">
    <input type="tel" id="customerPhone" oninput="saveCustomerData()" placeholder="ุดูุงุฑู ููุจุงู" class="w-full p-4 rounded-xl border outline-none focus:ring-2 focus:ring-blue-500">
    <textarea id="customerAddress" oninput="saveCustomerData()" placeholder="ุขุฏุฑุณ ุฏูู ูพุณุช" rows="3" class="w-full p-4 rounded-xl border outline-none focus:ring-2 focus:ring-blue-500"></textarea>
</div>
                <div class="mt-8 p-4 bg-blue-50 rounded-2xl border-2 border-dashed border-blue-200">
    <p class="text-blue-800 text-sm font-bold mb-4 text-center">
        ๐ ูุฑุญูู ููุง: ฺฉ ุงุฒ ูพุงูโุฑุณุงูโูุง ุฒุฑ ุฑุง ุจุฑุง ุงุฑุณุงู ูุณุช ุงูุชุฎุงุจ ฺฉูุฏ:
    </p>

    <div class="grid grid-cols-2 gap-3">
        <button onclick="submitOrder('whatsapp')" 
            class="flex flex-col items-center justify-center bg-green-500 text-white py-3 rounded-2xl shadow-lg hover:bg-green-600 active:scale-95 transition-all">
            <span class="text-xl mb-1">๐ฌ</span>
            <span class="font-bold text-sm">ุงุฑุณุงู ูุงุชุณโุขูพ</span>
        </button>

        <button onclick="submitOrder('eitaa')" 
            class="flex flex-col items-center justify-center bg-orange-500 text-white py-3 rounded-2xl shadow-lg hover:bg-orange-600 active:scale-95 transition-all">
            <span class="text-xl mb-1">๐</span>
            <span class="font-bold text-sm">ุงุฑุณุงู ุฏุฑ ุงุชุง</span>
        </button>
    </div>

    <button onclick="clearCart()" class="w-full mt-4 text-gray-400 text-xs hover:text-red-500 transition">
        ๐๏ธ ุงูุตุฑุงู ู ูพุงฺฉ ฺฉุฑุฏู ุณุจุฏ ุฎุฑุฏ
    </button>
</div>
            </div>
        </section>

        <section id="aboutScreen" class="hidden-section container mx-auto px-4 py-10 max-w-4xl">
            <div class="bg-white rounded-3xl shadow-xl p-8 border border-gray-100">
    <h2 class="text-3xl font-bold text-blue-900 mb-6">ุฏุฑุจุงุฑู ูุง</h2>
    <p class="text-gray-700 leading-8 mb-6 text-justify">ุงูุชุดุงุฑุงุช ูพูุณุชุฑ ุงุฑุงู ุจุง ุงูุชุฎุงุฑ ฺฉ ุงุฒ ูพุดฺฏุงูุงู ุฏุฑ ุฒููู ุชููุฏ ู ฺุงูพ ูพูุณุชุฑ ุฏุฑ ฺฉุดูุฑ ุงุณุช. ูุง ุจุง ุชฺฉู ุจุฑ ุณุงูโูุง ุชุฌุฑุจู ุฏุฑ ุฒููู ฺุงูพ ู ุดูุงุฎุช ุฏูู ุงุฒ ูุงุฒูุง ูุธุงู ุขููุฒุดุ ูุฌููุนูโุง ุงุฒ ูพูุณุชุฑูุง ุฌุฐุงุจุ ฺฉุงุฑุจุฑุฏ ู ููุงููฺฏ ุจุง ูุญุชูุง ฺฉุชุจ ุฏุฑุณ ูุฏุงุฑุณ ุชูู ฺฉุฑุฏูโุงู ุชุง ูุฑุขูุฏ ุงุฏฺฏุฑ ุฑุง ุจุฑุง ุฏุงูุดโุขููุฒุงู ุณุงุฏูโุชุฑุ ุนููโุชุฑ ู ูุฐุชโุจุฎุดโุชุฑ ฺฉูู.

ูพูุณุชุฑูุง ุขููุฒุด ุจุง ุทุฑุงุญ ุญุฑููโุงุ ฺุงูพ ุชูุงูโุฑูฺฏุ ุจุง ฺฉูุช ุนุงู ู ูุญุชูุง ุงุณุชุงูุฏุงุฑุฏุ ุงุจุฒุงุฑ ฺฉุงุฑุขูุฏ ุจุฑุง ูุนููุงูุ ุฏุงูุดโุขููุฒุงู ู ูุฏุงุฑุณ ุฏุฑ ุณุฑุงุณุฑ ฺฉุดูุฑ ุจู ุดูุงุฑ ูโุขูุฏ. "ูพูุณุชุฑ ุงุฑุงู" ูููุงุฑู ุฏุฑ ุชูุงุด ุงุณุช ุชุง ุจุง ููุขูุฑ ู ูพุงุจูุฏ ุจู ุงุตูู ุขููุฒุดุ ููุด ูุคุซุฑ ุฏุฑ ุงุฑุชูุงุก ุณุทุญ ุขููุฒุด ุงูุง ฺฉูุฏ.</p>
    <div class="space-y-4 text-gray-600">
        <p> ุชูุฑุงู: ุฎุงุจุงู ูพุงูุฒุฏู ุฎุฑุฏุงุฏ ุ ุจุงุฒุงุฑ ุขููฺฏุฑุงู ุ ฺฉูฺู ูุณุฌุฏุฌุงูุน ุ ูพุงุณุงฺ ฺฉุงุบุฐูุชุญุฑุฑุ ุฒุฑุฒูู ุงูู ุ ูพูุงฺฉ ทด</p>
        <p>๐ ุชููู: ฐฒฑตตถฑฑธทต</p>
        <p>๐ฑ ููุจุงู: ฐนฐฑฐฑนตธธต</p>
    </div>
            </div>
        </section>
        <section id="historyScreen" class="hidden-section container mx-auto px-4 py-10 max-w-4xl">
    <div class="bg-white rounded-3xl shadow-xl p-6 border">
        <h2 class="text-3xl font-bold text-gray-800 mb-6 pb-4 border-b">๐ ุชุงุฑุฎฺู ุณูุงุฑุดุงุช</h2>
        <div id="historyList" class="space-y-6">
            <p class="text-gray-400 text-center py-10">ูููุฒ ูฺ ุณูุงุฑุด ุซุจุช ูุดุฏู ุงุณุช.</p>
        </div>
    </div>
</section>
    </main>

    <nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-lg border-t border-gray-200 z-[100] flex justify-around items-center py-2 shadow-lg">
        <button onclick="showScreen('home')" id="nav-home" class="flex flex-col items-center gap-1 text-blue-700 transition flex-1">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
            <span class="text-[10px] font-bold">ุฎุงูู</span>
        </button>
        <button onclick="showScreen('gallery')" id="nav-gallery" class="flex flex-col items-center gap-1 text-gray-500 transition flex-1">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg>
            <span class="text-[10px] font-bold">ฺฏุงูุฑ</span>
        </button>
        <button onclick="showScreen('cart')" id="nav-cart" class="flex flex-col items-center gap-1 text-gray-500 transition flex-1 relative">
            <div class="relative">
                <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                <span class="cartBadge absolute -top-1 -right-1 bg-red-500 text-white text-[9px] w-4 h-4 flex items-center justify-center rounded-full hidden">0</span>
            </div>
            <span class="text-[10px] font-bold">ุณุจุฏ ุฎุฑุฏ</span>
        </button>
        <button onclick="showScreen('history')" id="nav-history" class="flex flex-col items-center gap-1 text-gray-500 flex-1">
    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
    </svg>
    <span class="text-[10px] font-bold">ุณูุงุฑุดุงุช</span>
</button>
        <button onclick="showScreen('about')" id="nav-about" class="flex flex-col items-center gap-1 text-gray-500 transition flex-1">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <span class="text-[10px] font-bold">ุฏุฑุจุงุฑู ูุง</span>
        </button>
    </nav>

    <script>
        // ฑ. ุชูุงุจุน ฺฉูฺฉ ุชุจุฏู ุงุนุฏุงุฏ ู ุงุนูุงู
        function toPersianDigits(n) {
            const farsiDigits = ['ฐ', 'ฑ', 'ฒ', 'ณ', 'ด', 'ต', 'ถ', 'ท', 'ธ', 'น'];
            return n.toString().replace(/\d/g, x => farsiDigits[x]);
        }

        function toPersianPrice(n) {
            return toPersianDigits(n.toLocaleString());
        }

        let toastTimer; // ุงู ูุชุบุฑ ุจุงุฏ ุจุฑูู ุงุฒ ุชุงุจุน ุจุงุดุฏ

function showToast(message, groupName = "") {
    const toast = document.getElementById('toast');
    const toastText = document.getElementById('toastText');
    const toastGroup = document.getElementById('toastGroup');
    
    toastText.innerText = message;
    toastGroup.innerText = groupName ? ` ${groupName}` : "";
    
    toast.classList.remove('toast-hidden');
    toast.classList.add('toast-visible');

    setTimeout(() => {
        toast.classList.remove('toast-visible');
        toast.classList.add('toast-hidden');
    }, 3000);
}

        // ฒ. ุฏุงุฏูโูุง ูุญุตููุงุช
        const groupInfo = {
            1: { name: "ุณุงุฒ ฒนรฒฑ ุฏูุฑูฺุงูพ", images: [
                { filename: "ุฌุฏูู ุฏูุณุช ุชูุฑู.jpg", name: "ุฌุฏูู ุฏูุณุช ุชูุฑู", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
                { filename: "ุฌุฏูู ุฏูุณุช ฺฉุงูู.jpg", name: "ุฌุฏูู ุฏูุณุช ฺฉุงูู", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
                { filename: "ุถุฑุจ ู ุชูุณู ุญูุงูุงุช.jpg", name: "ุถุฑุจ ู ุชูุณู ุญูุงูุงุช", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
                { filename: "ุถุฑุจ ู ุชูุณู.jpg", name: "ุถุฑุจ ู ุชูุณู", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
                { filename: "ุญุณุงุจ ุขููุฒ ุงูู (ุนููุฏ).jpg", name: "ุญุณุงุจ ุขููุฒ ุงูู", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
                { filename: "ุงุนุฏุงุฏ.jpg", name: "ุงุนุฏุงุฏ ุณุงุฏู", price: 125000, allowedQuantities: [0, 50, 100, 200, 300, 400, 500] },
            ]},
            3: { name: "ุณุงุฒ ตฐรณต ุฏูุฑูฺุงูพ", images: [
                { filename: "ุฌุฏูู ุฏูุณุช ฺฉุงูู.jpg", name: "ุฌุฏูู ุฏูุณุช ฺฉุงูู", price: 250000, allowedQuantities: [0, 50, 100, 200] },
                { filename: "ุขููุฒุด ุฒูุงู ู ุณุงุนุช.jpg", name: "ุขููุฒุด ุฒูุงู ู ุณุงุนุช", price: 250000, allowedQuantities: [0, 50, 100, 200] },
            ]},
            4: { name: "ุณุงุฒ ทฐรตฐ ฺฉุฑูฺุงูพ", images: [
                { filename: "ุงููุจุง ูุงุฑุณ ุดฺฉู ุฏุงุฑ.jpg", name: "ุงููุจุง ูุงุฑุณ ุดฺฉู ุฏุงุฑ", price: 250000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุฌุฏูู ุฏูุณุช.jpg", name: "ุฌุฏูู ุฏูุณุช", price: 250000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุฌุฏูู ุถุฑุจ.jpg", name: "ุฌุฏูู ุถุฑุจ", price: 250000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุฌุฏูู ุฌูุน.jpg", name: "ุฌุฏูู ุฌูุน", price: 250000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุงุนุฏุงุฏ 1 ุชุง 100.jpg", name: "ุงุนุฏุงุฏ 1 ุชุง 100", price: 250000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
            ]},
            5: { name: "ุณุงุฒ ทฐรตฐ ูู", images: [
                { filename: "ุดูุฑฺฉ ุงููุจุง.jpg", name: "ุดูุฑฺฉ ุงููุจุง", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุขูุงุชููู ุจูุฏู ุงูุณูุงู.jpg", name: "ุขูุงุชููู ุจูุฏู ุงูุณูุงู", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุจูุฏู ูู.jpg", name: "ุจูุฏู ูู", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุดฺฉู ุตุฏุงูุง ู ุงููุจุง ูุงุฑุณ.jpg", name: "ุดฺฉู ุตุฏุงูุง ู ุงููุจุง ูุงุฑุณ", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุขููุฒุด ุฒูุงู ูุณุงุนุช.jpg", name: "ุขููุฒุด ุฒูุงู ูุณุงุนุช", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุถุฑุจ ุชูุฑู ุณุชูู.jpg", name: "ุถุฑุจ ุชูุฑู ุณุชูู", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุถุฑุจ ุชูุฑู ูุฑุจุน.jpg", name: "ุถุฑุจ ุชูุฑู ูุฑุจุน", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุงุนุฏุงุฏ ฺฉ ุชุง ุตุฏ.jpg", name: "ุงุนุฏุงุฏ ฺฉ ุชุง ุตุฏ", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุงุนุฏุงุฏ ุฏู ุชุง ูุฒุงุฑ.jpg", name: "ุงุนุฏุงุฏ ุฏู ุชุง ูุฒุงุฑ", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุฌุฏูู ุชูุงูุจ ุนูุงุตุฑ.jpg", name: "ุฌุฏูู ุชูุงูุจ ุนูุงุตุฑ", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ุจุฑูุงูู ููุชฺฏ.jpg", name: "ุจุฑูุงูู ููุชฺฏ", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ููุดูู ุงูุฑุงู.webp", name: "ููุดูู ุงูุฑุงู", price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
                { filename: "ููุดูู ุฌููุงู.webp", name: "ููุดูู ุฌููุงู" , price: 350000, allowedQuantities: [0, 20, 50, 100, 200, 300, 500] },
            ]},
            6: { name: "ุณุงุฑ ูุญุตููุงุช", images: [
                { filename: "ุฏูุชุฑฺู ุง ุจุฒุฑฺฏ ุถุฑุจ.jpeg", name: "ุฏูุชุฑฺู ุง ุจุฒุฑฺฏ ุถุฑุจ", price: 350000, allowedQuantities: [0, 60, 120, 240, 480] },
                { filename: "ุฏูุชุฑฺู ุง ฺฉูฺฺฉ ุถุฑุจ.jpeg", name: "ุฏูุชุฑฺู ุง ฺฉูฺฺฉ ุถุฑุจ", price: 300000, allowedQuantities: [0, 60, 120, 240, 480] },
                { filename: "ุฏูุชุฑฺู ุง ุจุฒุฑฺฏ ุงููุจุง.jpeg", name: "ุฏูุชุฑฺู ุง ุจุฒุฑฺฏ ุงููุจุง", price: 350000, allowedQuantities: [0, 60, 120, 240, 480] },
                { filename: "ุงุณุชฺฉุฑ A4.jpeg", name: "ุงุณุชฺฉุฑ A4", price: 65000, allowedQuantities: [0, 100, 200, 300, 400, 500, 1200, 2400] },
            ]}
        };

        let cart = {};

        // ณ. ูุฏุฑุช ุตูุญุงุช
        function showScreen(screenId, shouldScroll = true) {
    // ูุฎู ฺฉุฑุฏู ุชูุงู ุจุฎุดโูุง
    document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden-section'));
    
    // ููุงุด ุจุฎุด ููุฑุฏ ูุธุฑ
    const targetScreen = document.getElementById(screenId + 'Screen');
    if (targetScreen) {
        targetScreen.classList.remove('hidden-section');
    }
    
    // ุจูโุฑูุฒุฑุณุงู ุงุณุชุงู ุฏฺฉููโูุง ูุงูุจุฑ (ููู ูพุงู)
    document.querySelectorAll('nav button').forEach(btn => {
        btn.classList.replace('text-blue-700', 'text-gray-500');
    });
    const activeNav = document.getElementById('nav-' + screenId);
    if (activeNav) {
        activeNav.classList.replace('text-gray-500', 'text-blue-700');
    }
    
    // ุงุฌุฑุง ููุทูโูุง ุฎุงุต ูุฑ ุตูุญู
    if (screenId === 'history') updateHistoryDisplay();
    if (screenId === 'cart') updateCartDisplay();
    if (screenId === 'gallery') loadImages(); 
    
    // ุญู ูุดฺฉู ูพุฑุด ุตูุญู: ููุท ุงฺฏุฑ ุฏุฑุฎูุงุณุช ุดุฏู ุจูุฏ ุจู ุจุงูุง ุจุฑู
    if (shouldScroll) {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
}

        // ด. ููุงุด ฺฏุงูุฑ ุชุตุงูุฑ
        function loadImages() {
            const groupId = document.getElementById('groupSelect').value;
            const info = groupInfo[groupId];
            const container = document.getElementById('imagesContainer');
            container.innerHTML = '';
            
            if (!info) return;
            
            info.images.forEach(img => {
                const productId = info.name + "_" + img.filename;
                const currentQty = cart[productId]?.quantity || 0;
                const qtys = img.allowedQuantities || [0, 50, 100, 200];
                
                const box = document.createElement('div');
                box.className = 'image-box bg-white p-3 rounded-2xl border shadow-sm flex flex-col items-center';
                
                let optionsHtml = qtys.map(q =>
                    `<option value="${q}" ${q === currentQty ? 'selected' : ''}>${toPersianDigits(q)}</option>`
                ).join('');
                
                box.innerHTML = `
                    <img src="https://akbari5561.github.io/PosterIran/images/${encodeURIComponent(img.filename)}" class="w-full h-32 object-contain mb-2 rounded-lg bg-gray-50">
                    <h4 class="font-bold text-[11px] text-center h-8 overflow-hidden text-blue-900 mb-1">${img.name}</h4>
                    <p class="text-blue-600 font-black text-[12px] mb-2">${toPersianPrice(img.price)} ุฑุงู</p>
                    
                    <div class="flex items-center justify-between w-full bg-blue-50 rounded-xl p-1 border border-blue-100 relative">
                        <button onclick="updateStep('${img.filename}', '${img.name}', ${img.price}, 1, ${JSON.stringify(qtys)}, '${info.name}')" 
                                class="w-8 h-8 flex items-center justify-center bg-white rounded-lg shadow-sm text-blue-600 font-bold z-10">+</button>
                        
                        <div class="flex-1 flex justify-center items-center h-8 relative">
                            <span class="font-bold text-blue-900 text-sm">${toPersianDigits(currentQty)}</span>
                            <select onchange="addToCart('${img.filename}', '${img.name}', this.value, ${img.price}, '${info.name}'); loadImages();" 
                                    class="qty-select">
                                ${optionsHtml}
                            </select>
                        </div>

                        <button onclick="updateStep('${img.filename}', '${img.name}', ${img.price}, -1, ${JSON.stringify(qtys)}, '${info.name}')" 
                                class="w-8 h-8 flex items-center justify-center bg-white rounded-lg shadow-sm text-red-500 font-bold z-10">-</button>
                    </div>
                `;
                container.appendChild(box);
            });
        }

        // ต. ูุฏุฑุช ุชุบุฑ ุชุนุฏุงุฏ ู ุงูุฒูุฏู ุจู ุณุจุฏ
        function updateStep(filename, name, price, direction, allowedQtys, groupName) {
    const productId = groupName + "_" + filename;
    const currentQty = cart[productId]?.quantity || 0;
    const currentIndex = allowedQtys.indexOf(currentQty);
    let nextIndex = currentIndex + direction;

    if (nextIndex >= 0 && nextIndex < allowedQtys.length) {
        const newQty = allowedQtys[nextIndex];
        // ุงุถุงูู ฺฉุฑุฏู ูพุงุฑุงูุชุฑ ุขุฎุฑ (allowedQtys) ุจุณุงุฑ ููู ุงุณุช
        addToCart(filename, name, newQty, price, groupName, allowedQtys);
        loadImages();
    }
}

        function addToCart(filename, name, qty, price, groupName, allowedQtys) {
    const productId = groupName + "_" + filename;
    if (qty === 0) {
        delete cart[productId];
    } else {
        cart[productId] = {
            filename: filename,
            name: name,
            quantity: qty,
            price: price,
            groupName: groupName,
            allowedQtys: allowedQtys // ุฐุฎุฑู ูุณุช ฺฏุงูโูุง ุจุฑุง ุณุจุฏ ุฎุฑุฏ
        };
    }
    updateBadge();
    saveCartToStorage();
    showToast(`${name} (${toPersianDigits(qty)} ุนุฏุฏ)`, groupName);
}

        function updateBadge() {
            const count = Object.keys(cart).length;
            document.querySelectorAll('.cartBadge').forEach(badge => {
                badge.innerText = toPersianDigits(count);
                badge.classList.toggle('hidden', count === 0);
            });
        }

        // ถ. ููุงุด ุณุจุฏ ุฎุฑุฏ ู ุงุฑุณุงู ุณูุงุฑุด
        function updateCartDisplay() {
    validateCart();
    const list = document.getElementById('cartList');
    const totalDisplay = document.getElementById('totalPrice');
    const items = Object.values(cart);
    
    if (items.length === 0) {
        list.innerHTML = `
            <div class="text-center py-20">
                <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-200">
                    <i class="fas fa-shopping-basket text-2xl"></i>
                </div>
                <p class="text-gray-400 font-bold">ุณุจุฏ ุฎุฑุฏ ุดูุง ุฎุงู ุงุณุช</p>
            </div>`;
        totalDisplay.innerText = 'ฐ ุฑุงู';
        return;
    }

    const grouped = items.reduce((acc, item) => {
        const gName = item.groupName || "ุณุงุฑ ูุญุตููุงุช";
        (acc[gName] = acc[gName] || []).push(item);
        return acc;
    }, {});

    let total = 0;
    let htmlContent = '';

    // ุจุฎุด ฑ: ูุณุช ูุญุตููุงุช (ููุท ููุงุด ุชุนุฏุงุฏ ู ูุงู)
    for (const gName in grouped) {
        htmlContent += `
        <div class="mb-4 bg-white border border-gray-100 rounded-3xl overflow-hidden shadow-sm">
            <div class="bg-gray-50/80 px-5 py-2 border-b border-gray-100 flex items-center gap-2">
                <div class="w-1 h-3 bg-blue-600 rounded-full"></div>
                <span class="text-[10px] font-black text-gray-700">${gName}</span>
            </div>
            <div class="divide-y divide-gray-50">`;

        grouped[gName].forEach(item => {
            const itemTotal = item.quantity * item.price;
            total += itemTotal;
            htmlContent += `
            <div class="p-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gray-50 rounded-xl overflow-hidden border border-gray-100 flex-shrink-0">
                        <img src="https://akbari5561.github.io/PosterIran/images/${encodeURIComponent(item.filename)}" class="w-full h-full object-cover" onerror="this.src='https://via.placeholder.com/100?text=P'">
                    </div>
                    <div>
                        <h4 class="text-[11px] font-bold text-gray-800">${item.name}</h4>
                        <p class="text-[10px] text-blue-600 font-bold mt-0.5">${toPersianDigits(item.quantity)} ุนุฏุฏ</p>
                    </div>
                </div>
                <div class="text-[11px] font-black text-gray-900">${toPersianPrice(itemTotal)} ุฑุงู</div>
            </div>`;
        });
        htmlContent += `</div></div>`;
    }

    // ุจุฎุด ฒ: ุฎูุงุตู ุณูุงุฑุด ุจุฑ ุงุณุงุณ ฺฏุฑูู (ูุฌุฏุฏุงู ุงุถุงูู ุดุฏ)
    htmlContent += `
    <div class="mt-6 p-5 bg-blue-50/50 rounded-[2rem] border-2 border-blue-100/50">
        <h3 class="text-[11px] font-black text-blue-900 mb-4 flex items-center gap-2">
            <i class="fas fa-chart-pie"></i> ุฎูุงุตู ฺฏุฑููโูุง:
        </h3>
        <div class="space-y-3">`;

    for (const gName in grouped) {
        let gQty = 0;
        let gTotal = 0;
        grouped[gName].forEach(item => {
            gQty += Number(item.quantity);
            gTotal += (item.quantity * item.price);
        });

        htmlContent += `
            <div class="flex flex-col border-b border-blue-100/30 pb-2 last:border-0">
                <div class="flex justify-between items-center mb-1">
                    <span class="text-[11px] font-bold text-gray-700">${gName}</span>
                    <span class="text-[11px] font-black text-blue-600">${toPersianPrice(gTotal)} ุฑุงู</span>
                </div>
                <span class="text-[9px] text-gray-500 italic">ุชุนุฏุงุฏ ฺฉู ุงู ุฏุณุชู: ${toPersianDigits(gQty)} ุนุฏุฏ</span>
            </div>`;
    }
    htmlContent += `</div></div>`;

    // ุจุฎุด ณ: ูุงฺฉุชูุฑ ููุง
    let discountPercent = (total >= 1000000000) ? 0.1 : (total >= 500000000 ? 0.07 : (total >= 200000000 ? 0.05 : 0));
    let discount = total * discountPercent;
    let afterDiscount = total - discount;
    let packageCount = Math.floor(afterDiscount / 140000000) + 1;
    let shipping = packageCount * 800000;
    let finalPayable = afterDiscount + shipping;

    htmlContent += `
    <div class="mt-6 p-6 bg-slate-900 rounded-[2.5rem] text-white shadow-xl">
        <div class="space-y-3 mb-6">
            <div class="flex justify-between text-[11px] opacity-60"><span>ูุฌููุน ฺฉุงูุงูุง:</span><span>${toPersianPrice(total)}</span></div>
            ${discount > 0 ? `<div class="flex justify-between text-[11px] text-emerald-400"><span>ุชุฎูู (${toPersianDigits(Math.round(discountPercent*100))}ูช):</span><span>${toPersianPrice(discount)}-</span></div>` : ''}
            <div class="flex justify-between text-[11px] opacity-60"><span>ูุฒูู ุงุฑุณุงู (${toPersianDigits(packageCount)} ุจุณุชู):</span><span>${toPersianPrice(shipping)}</span></div>
        </div>
        <div class="flex justify-between items-center pt-4 border-t border-white/10">
            <div class="flex flex-col">
                <span class="text-[10px] opacity-50">ูุจูุบ ูุงุจู ูพุฑุฏุงุฎุช:</span>
                <span class="font-black text-xl text-yellow-400 mt-1">${toPersianPrice(finalPayable)} <small class="text-[10px]">ุฑุงู</small></span>
            </div>
            <i class="fas fa-file-invoice-dollar text-3xl opacity-20"></i>
        </div>
    </div>`;

    list.innerHTML = htmlContent;
    totalDisplay.innerText = toPersianPrice(finalPayable) + ' ุฑุงู';
}

function changeQtyStepFromCart(productId, direction) {
    const item = cart[productId];
    if (!item || !item.allowedQtys) return;
    const steps = item.allowedQtys;
    const currentIndex = steps.indexOf(item.quantity);
    let nextIndex = currentIndex + direction;
    if (nextIndex >= 0 && nextIndex < steps.length) {
        addToCart(item.filename, item.name, steps[nextIndex], item.price, item.groupName, steps);
        updateCartDisplay();
        if(typeof loadImages === "function") loadImages();
    }
}
        function clearCart() {
    if(confirm('ุขุง ุงุฒ ูพุงฺฉ ฺฉุฑุฏู ุณุจุฏ ุฎุฑุฏ ูุทูุฆู ูุณุชุฏุ')) {
        cart = {}; // ุฎุงู ฺฉุฑุฏู ูุชุบุฑ ุฏุฑ ุจุฑูุงูู
        saveCartToStorage(); // ุจุฑูุฒุฑุณุงู LocalStorage
        updateBadge(); // ุตูุฑ ฺฉุฑุฏู ุนุฏุฏ ุฑู ุขฺฉูู ุณุจุฏ
        
        // ุญุฐู ูุดุงูฺฏุฑูุง ูุฑุจูุท ุจู ุณูุงุฑุดุงุช ูุงุชูุงู
        localStorage.removeItem('cart_submitted'); 
        // ุงฺฏุฑ ูุชุบุฑ ุฏฺฏุฑ ุจุฑุง ูพฺฏุฑ ุณุจุฏ ูุงุชูุงู ุฏุงุฑุฏ ุงูุฌุง ุงุถุงูู ฺฉูุฏ
        
        showScreen('gallery'); // ุจุงุฒฺฏุดุช ุจู ุตูุญู ุงุตู
        showToast('ุณุจุฏ ุฎุฑุฏ ุจุง ููููุช ูพุงฺฉ ุดุฏ', 'ุญุฐู');
        
        // ููุณุงุฒ ููุงุด ุณุจุฏ ุฎุฑุฏ (ุงฺฏุฑ ุฏุฑ ุขู ุตูุญู ุจุงุดุฏ)
        if (typeof updateCartDisplay === 'function') updateCartDisplay();
    }
}

        function submitOrder(platform) {
    const name = document.getElementById('customerName').value;
    const phone = document.getElementById('customerPhone').value;
    const address = document.getElementById('customerAddress').value;
    
    if (!name || !phone || !address || Object.keys(cart).length === 0) {
        alert('ูุทูุงู ุงุทูุงุนุงุช ูพุณุช ุฑุง ุชฺฉูู ฺฉูุฏ ู ูุทูุฆู ุดูุฏ ุณุจุฏ ุฎุฑุฏ ุฎุงู ูุณุช.');
        return;
    }
    
    const now = new Date();
    const dateStr = now.toLocaleDateString('fa-IR');
    const timeStr = now.toLocaleTimeString('fa-IR', { hour: '2-digit', minute: '2-digit' });
    const orderNum = getOrderNumber(); // ุฏุฑุงูุช ุดูุงุฑู ุณูุงุฑุด ุงุฒ localStorage
    
    let text = `๐๏ธ ุชุงุฑุฎ: ${dateStr} | ุณุงุนุช: ${timeStr}\n`;
    text += `๐๏ธ ุณูุงุฑุด ุฌุฏุฏ - ุดูุงุฑู: ${toPersianDigits(orderNum)}\n`;
    text += `๐ค ูุงูโููุงูโุฎุงููุงุฏฺฏ: ${name}\n`;
    text += `๐ฑ ููุฑุงู: ${phone}\n`;
    text += `๐ ุขุฏุฑุณ: ${address}\n\n`;
    text += `๐ ุฌุฒุฆุงุช ุณูุงุฑุด:\n`;
    text += `---------------------------------------\n`;
    
    const items = Object.values(cart);
    const grouped = items.reduce((acc, item) => {
    (acc[item.groupName] = acc[item.groupName] || []).push(item); // ุชุบุฑ ุจู groupName
    return acc;
}, {});
    
    let total = 0;
    let groupSummariesText = `๐ ุฎูุงุตู ุณูุงุฑุด ุจุฑ ุงุณุงุณ ฺฏุฑูู:\n\n`;
    
    for (const groupName in grouped) {
        let groupQty = 0;
        let groupTotal = 0;
        text += `\n๐น ${groupName}:\n`;
        
        grouped[groupName].forEach(item => {
            let itemSum = item.quantity * item.price;
            text += `- ${item.name}: ${toPersianDigits(item.quantity)} ุนุฏุฏ\n`;
            groupQty += item.quantity;
            groupTotal += itemSum;
            total += itemSum;
        });
        
        // ุชููุฏ ุจุฎุด ุฎูุงุตู ุจุฑุง ุงูุชูุง ูพุงู (ูุทุงุจู ุฏุฑุฎูุงุณุช ุดูุง)
        groupSummariesText += `${groupName}:\nุชุนุฏุงุฏ ฺฉู: ${toPersianDigits(groupQty)} ุนุฏุฏ - ูุฌููุน ููุช: ${toPersianPrice(groupTotal)} ุฑุงู\n\n`;
    }
    
    // ูุญุงุณุจุงุช ููุง ูุจูุบ
    let discountPercent = (total >= 1000000000) ? 0.10 : (total >= 500000000 ? 0.07 : (total >= 200000000 ? 0.05 : 0));
    let discountAmount = total * discountPercent;
    let afterDiscount = total - discountAmount;
    let packageCount = Math.floor(afterDiscount / 140000000) + 1;
    let shippingCost = packageCount * 800000;
    let finalPayable = afterDiscount + shippingCost;
    
    text += `\n---------------------------------------\n`;
    text += groupSummariesText; // ุฏุฑุฌ ุจุฎุด ุฏุฑุฎูุงุณุช ุดูุง
    text += `---------------------------------------\n\n`;
    text += `๐ต ุฌูุน ฺฉู: ${toPersianPrice(total)} ุฑุงู\n`;
    
    if (discountAmount > 0) {
        text += `๐ ุชุฎูู ูฺู: ${toPersianPrice(discountAmount)} ุฑุงู (${toPersianDigits(Math.round(discountPercent * 100))}ูช))\n`;
    }
    
    text += `๐ ูุฒูู ุจุงุฑุจุฑ: ${toPersianPrice(shippingCost)} ุฑุงู\n`;
    text += `๐ฐ ูุจูุบ ูุงุจู ูพุฑุฏุงุฎุช: ${toPersianPrice(finalPayable)} ุฑุงู\n\n`;
    text += `โ ุณูุงุฑุด ุดูุง ุจุง ููููุช ุซุจุช ุดุฏ . ุฏุฑ ุงุณุฑุน ููุช ุณูุงุฑุด ุดูุง ุจุฑุฑุณ ู ููุงููฺฏ ูุงุฒู ุจุง ุดูุง ุตูุฑุช ูโฺฏุฑุฏ. ูพูุณุชุฑ ุงุฑุงู`;
    
    // ฺฉูพ ูุชู ู ุงุฑุณุงู
    addToHistory();
    incrementOrderNumber();
    
    navigator.clipboard.writeText(text).then(() => {
        // ุฏุฑ ุฏุงุฎู ุชุงุจุน submitOrder
if (platform === 'eitaa') {
    navigator.clipboard.writeText(text).then(() => {
        showToast("ูุชู ุณูุงุฑุด ฺฉูพ ุดุฏ. ุฏุฑ ุงุชุง ุจฺุณุจุงูุฏ (Paste)", "ุณุณุชู", "success");
        setTimeout(() => {
            window.open(`https://eitaa.com/@PosterIran`, '_blank');
        }, 1000);
    });
}
        
        cart = {};
        saveCartToStorage();
        updateBadge();
        
        const url = platform === 'whatsapp' ?
            `https://wa.me/989010195885?text=${encodeURIComponent(text)}` :
            `https://eitaa.com/@PosterIran`;
        
        window.open(url);
        setTimeout(() => showScreen('history'), 1000);
    });
}
// ุชุงุจุน ุจุฑุง ุฐุฎุฑู ุงุทูุงุนุงุช ุฏุฑ ุญุงูุธู ูุฑูุฑฺฏุฑ
function saveCustomerData() {
    const customerData = {
        name: document.getElementById('customerName').value,
        phone: document.getElementById('customerPhone').value,
        address: document.getElementById('customerAddress').value
    };
    localStorage.setItem('customer_info', JSON.stringify(customerData));
}

// ุชุงุจุน ุจุฑุง ุฎูุงูุฏู ุงุทูุงุนุงุช ุงุฒ ุญุงูุธู ูุฑูุฑฺฏุฑ
function loadCustomerData() {
    const savedData = localStorage.getItem('customer_info');
    if (savedData) {
        const data = JSON.parse(savedData);
        document.getElementById('customerName').value = data.name || '';
        document.getElementById('customerPhone').value = data.phone || '';
        document.getElementById('customerAddress').value = data.address || '';
    }
}

// ุงุฌุฑุง ุชุงุจุน ููุฏ ุจูุงูุงุตูู ูพุณ ุงุฒ ุจุงุฒ ุดุฏู ุตูุญู
window.addEventListener('DOMContentLoaded', loadCustomerData);
// ฑ. ุงู ุชุงุจุน ุฑุง ุจุฑุง ุจุฑุฑุณ ูุถุนุช ุณุจุฏ ููฺฏุงู ูุฑูุฏ ุจู ุณุงุช ุงุณุชูุงุฏู ฺฉูุฏ
function validateCartOnLoad() {
    const savedCartStr = localStorage.getItem('cart');
    
    // ุงฺฏุฑ ุณุจุฏ ุฎุฑุฏ ุฏุฑ ุญุงูุธู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
    if (savedCartStr) {
        try {
            const tempCart = JSON.parse(savedCartStr);
            const itemsInCart = Object.keys(tempCart).length;

            // ููุท ุฏุฑ ุตูุฑุช ูพุงู ุจุฏู ฺฉู:
            // ฑ. ุณุจุฏ ุฎุฑุฏ ูุงูุนุงู ุฏุงุฑุง ูุญุตูู ุจุงุดุฏ (ุจุฒุฑฺฏุชุฑ ุงุฒ ุตูุฑ)
            // ฒ. ูุดุงูฺฏุฑ ุซุจุช ูุดุฏู (cart_submitted) ุฏุฑ ุญุงูุธู ุจุงุดุฏ
            if (itemsInCart > 0 && localStorage.getItem('cart_submitted')) {
                
                // ููุงุด ูพุงู ุจุง ุชุงุฎุฑ ุงูุฏฺฉ ุจุฑุง ุจูุชุฑ ุฏุฏู ุดุฏู
                setTimeout(() => {
                    showCustomAlert(
                        "ุณุจุฏ ุฎุฑุฏ ูุงุชูุงู", 
                        `ุดูุง ุชุนุฏุงุฏ ${toPersianDigits(itemsInCart)} ููู ฺฉุงูุง ุฏุฑ ุณุจุฏ ุฎุฑุฏ ุฏุงุฑุฏ ฺฉู ุซุจุช ููุง ูุดุฏูโุงูุฏ. ูุทูุงู ุฌูุช ุชฺฉูู ุณูุงุฑุด ุจู ุณุจุฏ ุฎุฑุฏ ูุฑุงุฌุนู ฺฉูุฏ.`
                    );
                }, 1000);
                
            } else if (itemsInCart === 0) {
                // ุงฺฏุฑ ุณุจุฏ ุฎุงู ุงุณุชุ ูุดุงูฺฏุฑ ูุงุชูุงู ุจูุฏู ุฑุง ูู ูพุงฺฉ ฺฉู ุชุง ุชุฏุงุฎู ุงุฌุงุฏ ูุดูุฏ
                localStorage.removeItem('cart_submitted');
            }
        } catch (e) {
            console.error("ุฎุทุง ุฏุฑ ุฎูุงูุฏู ุณุจุฏ ุฎุฑุฏ:", e);
        }
    }
}

// ฒ. ูุฑุงุฎูุงู ุชุงุจุน ููฺฏุงู ููุฏ ุดุฏู ฺฉุงูู ุตูุญู
window.addEventListener('load', () => {
    // ุงุจุชุฏุง ุณุจุฏ ุฎุฑุฏ ุฑุง ุงุฒ ุญุงูุธู ุจุงุฑฺฏุฐุงุฑ ฺฉู (ุชุงุจุน ููุฌูุฏ ุฏุฑ ฺฉุฏ ุฎูุฏุชุงู)
    loadCartFromStorage(); 
    
    // ุณูพุณ ุจุฑุฑุณ ฺฉู ฺฉู ุขุง ูุงุฒ ุจู ููุงุด ูพุงู "ุณุจุฏ ูุงุชูุงู" ูุณุช ุง ุฎุฑ
    validateCartOnLoad();
    
    // ุจุฑูุฒุฑุณุงู ุขฺฉูู ุณุจุฏ ุฎุฑุฏ
    updateBadge();
});
// ุชุงุจุน ุจุฑุง ฺฏุฑูุชู ุดูุงุฑู ุณูุงุฑุด ูุนู
function getOrderNumber() {
    let currentNumber = localStorage.getItem('order_counter');
    if (!currentNumber) {
        // ุงฺฏุฑ ุจุงุฑ ุงูู ุงุณุชุ ุดูุงุฑู ุฑุง ฑ ูุฑุงุฑ ุจุฏู
        localStorage.setItem('order_counter', '1');
        return 1;
    }
    return parseInt(currentNumber);
}

// ุชุงุจุน ุจุฑุง ุงูุฒุงุด ุดูุงุฑู ุณูุงุฑุด ุจุฑุง ุฏูุนู ุจุนุฏ
function incrementOrderNumber() {
    let nextNumber = getOrderNumber() + 1;
    localStorage.setItem('order_counter', nextNumber.toString());
}
// ุฐุฎุฑู ุณุจุฏ ุฎุฑุฏ ุฏุฑ localStorage
const STORAGE_KEY = 'poster_iran_cart';

function saveCartToStorage() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(cart));
}

function loadCartFromStorage() {
    const savedCart = localStorage.getItem(STORAGE_KEY);
    if (savedCart) {
        try {
            cart = JSON.parse(savedCart);
            updateBadge();
            checkPendingOrder();
        } catch (e) {
            cart = {};
        }
    }
}

// ุงุฌุฑุง ุชุงุจุน ููุฏ ุจูุงูุงุตูู ูพุณ ุงุฒ ุจุงุฒ ุดุฏู ุตูุญู
window.addEventListener('DOMContentLoaded', () => {
    loadCustomerData();
    loadCartFromStorage();
});
function checkPendingCart() {
    const itemsCount = Object.keys(cart).length;
    if (itemsCount === 0) return; // ุงฺฏุฑ ุณุจุฏ ุฎุงู ุจูุฏุ ฺฉูุงู ุงุฏุงูู ูุฏู ู ูพุงู ูุดุงู ูุฏู
    
    // ุจูู ฺฉุฏูุง ููุงุด ุขูุฑุช...
}
function checkPendingOrder() {
    const notice = document.getElementById('pendingOrderNotice');
    const isCartEmpty = Object.keys(cart).length === 0;
    
    // ุงฺฏุฑ ุฏุฑ ุตูุญู ุงุตู ุจูุฏู ู ุณุจุฏ ูพุฑ ุจูุฏุ ููุงุด ุจุฏู
    if (!isCartEmpty) {
        notice.classList.remove('hidden');
    } else {
        notice.classList.add('hidden');
    }
}
window.addEventListener('DOMContentLoaded', () => {
    loadCustomerData(); // ุชุงุจุน ฺฉู ุฎูุฏุชุงู ุฏุงุดุชุฏ
    
    // ุจุงุฒุงุจ ุณุจุฏ ุฎุฑุฏ
    const savedCart = localStorage.getItem('saved_cart');
    if (savedCart) {
        cart = JSON.parse(savedCart);
        updateBadge();
        
        // ุงฺฏุฑ ุณุจุฏ ุฎุงู ูุจูุฏุ ุฏฺฉูู ุณูุงุฑุด ูุงุชูุงู ุฑุง ูุดุงู ุจุฏู
        if (Object.keys(cart).length > 0) {
            document.getElementById('resumeOrder')?.classList.remove('hidden');
        }
    }
});
// ุฐุฎุฑู ุณูุงุฑุด ุฏุฑ ุชุงุฑุฎฺู (ุงู ุชุงุจุน ุฑุง ุฏุฑ ุงูุชูุง ุชุงุจุน submitOrder ุตุฏุง ุจุฒูุฏ)
function addToHistory() {
    if (Object.keys(cart).length === 0) return;
    
    let history = JSON.parse(localStorage.getItem('order_history') || '[]');
    
    let itemsArray = Object.values(cart);
    let rawTotal = itemsArray.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    
    // ูุญุงุณุจุงุช ุชุฎูู ู ุจุงุฑุจุฑ
    let discountPercent = (rawTotal >= 1000000000) ? 0.10 : (rawTotal >= 500000000 ? 0.07 : (rawTotal >= 200000000 ? 0.05 : 0));
    let afterDiscount = rawTotal - (rawTotal * discountPercent);
    let packageCount = Math.floor(afterDiscount / 140000000) + 1;
    let finalPayable = afterDiscount + (packageCount * 800000);
    
    const newOrder = {
    id: Date.now(),
    orderNumber: getOrderNumber(),
    date: new Date().toLocaleDateString('fa-IR'),
    time: new Date().toLocaleTimeString('fa-IR', { hour: '2-digit', minute: '2-digit' }),
    items: JSON.parse(JSON.stringify(cart)), // ฺฉู ุดุก ุณุจุฏ ุดุงูู groupName ุฐุฎุฑู ูโุดูุฏ
    total: finalPayable
};
    
    history.unshift(newOrder);
    localStorage.setItem('order_history', JSON.stringify(history.slice(0, 15))); // ุฐุฎุฑู ุชุง ฑต ุณูุงุฑุด ุขุฎุฑ
}
// ููุงุด ูุณุช ุชุงุฑุฎฺู
function updateHistoryDisplay() {
    const list = document.getElementById('historyList');
    const history = JSON.parse(localStorage.getItem('order_history') || '[]');
    
    if (history.length === 0) {
        list.innerHTML = `
            <div class="text-center py-16">
                <div class="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-file-invoice text-3xl text-gray-300"></i>
                </div>
                <p class="text-gray-400 font-bold">ุชุงุฑุฎฺู ุณูุงุฑุดุงุช ุดูุง ุฎุงู ุงุณุช.</p>
            </div>`;
        return;
    }
    
    list.innerHTML = history.map((order, index) => {
        const items = Object.values(order.items);
        const groupedItems = items.reduce((acc, item) => {
            const gName = item.groupName || "ุณุงุฑ ูุญุตููุงุช";
            (acc[gName] = acc[gName] || []).push(item);
            return acc;
        }, {});
        
        return `
        <div class="bg-white border border-gray-100 rounded-[2rem] overflow-hidden shadow-sm mb-6 transition-all hover:shadow-md">
            <div class="bg-blue-50/50 px-6 py-4 flex justify-between items-center border-b border-blue-100/50">
                <div class="flex items-center gap-3">
                    <div class="bg-blue-600 text-white w-10 h-10 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-200">
                        <i class="fas fa-shopping-bag text-sm"></i>
                    </div>
                    <div>
                        <span class="block text-[10px] text-blue-500 font-bold">ุณูุงุฑุด ุดูุงุฑู ${toPersianDigits(order.orderNumber)}</span>
                        <span class="text-xs font-black text-gray-800">${order.date} <span class="text-gray-300 mx-1">|</span> ${order.time}</span>
                    </div>
                </div>
                <button onclick="deleteFromHistory(${order.id})" class="text-gray-300 hover:text-red-500 transition-colors p-2">
                    <i class="fas fa-trash-alt text-sm"></i>
                </button>
            </div>

            <div class="p-6">
                <div class="space-y-4">
                    ${Object.keys(groupedItems).map(groupName => `
                        <div class="bg-gray-50/50 rounded-2xl p-3 border border-gray-100">
                            <h4 class="text-[10px] font-black text-blue-900 mb-2 pb-2 border-b border-gray-200/50 flex items-center gap-2">
                                <span class="w-1.5 h-1.5 bg-blue-500 rounded-full"></span>
                                ${groupName}
                            </h4>
                            <div class="space-y-2">
                                ${groupedItems[groupName].map(item => `
                                    <div class="flex justify-between items-center text-[11px]">
                                        <span class="text-gray-600">${item.name}</span>
                                        <span class="font-bold text-gray-900">${toPersianDigits(item.quantity)} ุนุฏุฏ</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>

            <div class="px-6 pb-6 pt-2">
                <div class="flex justify-between items-center mb-4 px-2">
                    <span class="text-xs text-gray-500 font-bold">ูุจูุบ ููุง ูพุฑุฏุงุฎุช:</span>
                    <span class="text-sm font-black text-green-600">${toPersianPrice(order.total)} ุฑุงู</span>
                </div>
                <button onclick='reorder(${JSON.stringify(order.items)})' 
                        class="w-full bg-blue-600 text-white py-4 rounded-2xl text-xs font-bold hover:bg-blue-700 shadow-lg shadow-blue-100 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
                    <i class="fas fa-redo text-[10px]"></i>
                    ุณูุงุฑุด ูุฌุฏุฏ ุงู ูุณุช
                </button>
            </div>
        </div>
        `;
    }).join('');
}

// ุชุงุจุน ุฌุฏุฏ ุจุฑุง ุญุฐู ฺฉ ููุฑุฏ ุฎุงุต ุงุฒ ุชุงุฑุฎฺู
function deleteFromHistory(orderId) {
    if (confirm('ุขุง ุงุฒ ุญุฐู ุงู ุณูุงุฑุด ุงุฒ ุชุงุฑุฎฺู ูุทูุฆู ูุณุชุฏุ')) {
        let history = JSON.parse(localStorage.getItem('order_history') || '[]');
        history = history.filter(order => order.id !== orderId);
        localStorage.setItem('order_history', JSON.stringify(history));
        updateHistoryDisplay();
        showToast("ุณูุงุฑุด ุงุฒ ุชุงุฑุฎฺู ุญุฐู ุดุฏ", "ูุฏุฑุช");
    }
}

// ุชุงุจุน ฺฉูฺฉ ุจุฑุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ (ุงุฎุชุงุฑ)
function shareOrder(orderNum) {
    showToast(`ุฌุฒุฆุงุช ุณูุงุฑุด ${toPersianDigits(orderNum)} ุขูุงุฏู ฺฉูพ ุงุณุช`, "ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ");
}

function reorderFromHistory(oldItems) {
    const itemsToAdd = Object.values(oldItems);
    itemsToAdd.forEach(item => {
        // ุงุทููุงู ุงุฒ ุงุฑุณุงู groupName ฺฉู ุฏุฑ ุชุงุฑุฎฺู ุฐุฎุฑู ุดุฏู ุจูุฏ
        addToCart(item.filename, item.name, item.quantity, item.price, item.groupName || 'ุนููู');
    });
    
    showToast("ูุญุตููุงุช ุจู ุณุจุฏ ุฎุฑุฏ ุดูุง ุงุถุงูู ุดุฏูุฏ", "ุชุงุฑุฎฺู", "success");
    showScreen('cart');
}
// ูุงุจูุช ุณูุงุฑุด ูุฌุฏุฏ
function reorder(items) {
    if(confirm('ุขุง ูโุฎูุงูุฏ ุงู ุงููุงู ุจู ุณุจุฏ ุฎุฑุฏ ูุนู ุดูุง ุงุถุงูู ุดููุฏุ')) {
        const allValidProductIds = [];
        Object.values(groupInfo).forEach(group => {
            group.images.forEach(img => {
                allValidProductIds.push(group.name + "_" + img.filename);
            });
        });

        let missingItemsDetails = [];

        for (const id in items) {
            if (allValidProductIds.includes(id)) {
                cart[id] = items[id];
            } else {
                const item = items[id];
                missingItemsDetails.push(`๐ธ ${item.group} : ${item.name}`);
            }
        }

        saveCartToStorage();
        updateBadge();
        
        if (missingItemsDetails.length > 0) {
            alert("โ ููุงุฑุฏ ุฒุฑ ุฏฺฏุฑ ุฏุฑ ูุณุช ููุฌูุฏ ูุณุชูุฏ ู ุจู ุณุจุฏ ุงุถุงูู ูุดุฏูุฏ:\n\n" + missingItemsDetails.join("\n"));
        }
        
        showScreen('cart');
        showToast("ุณุจุฏ ุฎุฑุฏ ุจูโุฑูุฒุฑุณุงู ุดุฏ", "ูุฑูุดฺฏุงู", "success");
    }
}
window.addEventListener('DOMContentLoaded', () => {
    loadCustomerData();
    loadCartFromStorage();
    
    // ุงฺฏุฑ ุณุจุฏ ุฎุฑุฏ ูพุฑ ุจูุฏุ ูพุงู ูุดุฏุงุฑ ุฑุง ูุดุงู ุจุฏู
    const resumeSection = document.getElementById('resumeOrder');
    if (Object.keys(cart).length > 0) {
        resumeSection?.classList.remove('hidden');
    } else {
        resumeSection?.classList.add('hidden');
    }
});
// ุชุงุจุน ุจุฑุฑุณ ููุฌูุฏ ุจูุฏู ูุญุตููุงุช ุฏุฑ ูุณุช ุงุตู
function validateCart() {
    if (!cart || Object.keys(cart).length === 0) return;
    
    let removedItemsDetails = [];
    let updatedPriceItems = [];
    const validProductsMap = {};
    
    // ุงุฌุงุฏ ููุดู ูุญุตููุงุช ููุฌูุฏ ุจุฑ ุงุณุงุณ ูุณุช ุงุตู
    Object.values(groupInfo).forEach(group => {
        group.images.forEach(img => {
            const id = group.name + "_" + img.filename;
            validProductsMap[id] = {
                price: img.price,
                group: group.name,
                name: img.name
            };
        });
    });
    
    for (const productId in cart) {
        if (!validProductsMap[productId]) {
            // ููุฑุฏ ุงูู: ูุญุตูู ุฏุฑ ูุณุช ูุณุช (ุญุฐู ุดุฏู ุง ูุฎู ุดุฏู)
            removedItemsDetails.push(`๐น ${cart[productId].groupName} : ${cart[productId].name}`);
            // ููุฑุฏ ุฏูู: ูุญุตูู ูุณุช ูู ููุช ุชุบุฑ ฺฉุฑุฏู
            const currentPriceInCart = cart[productId].price;
            const latestPriceInList = validProductsMap[productId].price;
            
            if (currentPriceInCart !== latestPriceInList) {
                cart[productId].price = latestPriceInList;
                updatedPriceItems.push(`๐ธ ${cart[productId].name} (ููุช ุฌุฏุฏ: ${toPersianPrice(latestPriceInList)} ุฑุงู)`);
            }
        }
    }
    
    if (removedItemsDetails.length > 0 || updatedPriceItems.length > 0) {
        saveCartToStorage();
        updateBadge();
        
        let message = "";
        if (removedItemsDetails.length > 0) {
            message += "<b class='text-red-600'>ููุงุฑุฏ ุญุฐู ุดุฏู (ุนุฏู ููุฌูุฏ):</b><br>" + removedItemsDetails.join("<br>") + "<br><br>";
        }
        if (updatedPriceItems.length > 0) {
            message += "<b class='text-blue-600'>ููุงุฑุฏ ุจูโุฑูุฒุฑุณุงู ููุช:</b><br>" + updatedPriceItems.join("<br>");
        }
        
        showCustomAlert("ุจูโุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ุณุจุฏ", message);
    }
}
function showCustomAlert(title, message) {
    const modal = document.createElement('div');
    modal.className = "fixed inset-0 z-[9999] flex items-center justify-center p-6 bg-black/70 backdrop-blur-sm";
    modal.innerHTML = `
        <div class="bg-white rounded-[2rem] p-8 max-w-sm w-full shadow-2xl transform transition-all border-b-8 border-blue-600">
            <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-bell text-blue-600 text-2xl"></i>
            </div>
            <h3 class="text-gray-900 font-black text-center mb-4 text-sm">${title}</h3>
            <div class="text-[11px] text-gray-600 leading-relaxed mb-8 text-right bg-gray-50 p-4 rounded-xl border border-gray-100">
                ${message}
            </div>
            <button onclick="this.parentElement.parentElement.remove()" 
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-2xl text-xs shadow-lg shadow-blue-200 transition active:scale-95">
                ุชุงุฏ ู ูุดุงูุฏู ุณุจุฏ ุฎุฑุฏ
            </button>
        </div>
    `;
    document.body.appendChild(modal);
}
/**
 * ุชุงุจุน ุงุตู ุจุฑุง ุฑุงู ุงูุฏุงุฒ ุจุฑูุงูู ููฺฏุงู ุจุงุฑฺฏุฐุงุฑ ุตูุญู
 * ุงู ุชุงุจุน ุฌุงฺฏุฒู ฺฉุฏ ูุจู window.addEventListener('load') ุดูุง ูโุดูุฏ
 */
function initializeApplication() {
    // ฑ. ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏูโูุง ุงุฒ ุญุงูุธู ูุฑูุฑฺฏุฑ
    loadCartFromStorage();
    
    // ฒ. ุจุฑุฑุณ ูุฌูุฏ ุณุจุฏ ุฎุฑุฏ ูุงุชูุงู ู ููุงุด ูุดุฏุงุฑ ููุดููุฏ
    const savedCartStr = localStorage.getItem('cart');
    const isSubmitted = localStorage.getItem('cart_submitted');

    if (savedCartStr) {
        try {
            const tempCart = JSON.parse(savedCartStr);
            const itemsCount = Object.keys(tempCart).length;

            // ููุท ุงฺฏุฑ ุณุจุฏ ูุงูุนุงู ูพุฑ ุจุงุดุฏ ู ูุจูุงู ุฏฺฉูู ููุง ฺฉุฑุฏู ุฒุฏู ูุดุฏู ุจุงุดุฏ
            if (itemsCount > 0 && isSubmitted) {
                setTimeout(() => {
                    showCustomAlert(
                        "ุณุจุฏ ุฎุฑุฏ ูุงุชูุงู", 
                        `ุดูุง ุชุนุฏุงุฏ <b>${toPersianDigits(itemsCount)}</b> ููู ฺฉุงูุง ุฏุฑ ุณุจุฏ ุฎุฑุฏ ุฏุงุฑุฏ ฺฉู ุซุจุช ููุง ูุดุฏูโุงูุฏ. ูุทูุง ุฌูุช ุชฺฉูู ุณูุงุฑุด ุจู ุจุฎุด ุณุจุฏ ุฎุฑุฏ ูุฑุงุฌุนู ฺฉูุฏ.`
                    );
                }, 1200);
            } 
            // ุงฺฏุฑ ุณุจุฏ ุฎุงู ุงุณุช ุงูุง ูุดุงูฺฏุฑ ูุงุชูุงู ุจุงู ูุงูุฏูุ ูพุงฺฉุณุงุฒ ฺฉู
            else if (itemsCount === 0) {
                localStorage.removeItem('cart_submitted');
            }
        } catch (error) {
            console.error("ุฎุทุง ุฏุฑ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุญุงูุธู:", error);
        }
    }

    // ณ. ุจุฑูุฒุฑุณุงู ุฑุงุจุท ฺฉุงุฑุจุฑ (UI)
    updateBadge();      // ุขูพุฏุช ุนุฏุฏ ุฑู ุขฺฉูู ุณุจุฏ ุฎุฑุฏ
    if(typeof loadImages === 'function') loadImages(); // ุจุงุฑฺฏุฐุงุฑ ุชุตุงูุฑ ฺฏุงูุฑ
}

// ุงุฌุฑุง ุชุงุจุน ุฒูุงู ฺฉู ฺฉู ุณุงุฎุชุงุฑ ุตูุญู (DOM) ููุฏ ุดุฏ
window.addEventListener('DOMContentLoaded', initializeApplication);
    </script>
</body>
</html>