<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      background: #f0f4f8;
      color: #333;
      padding: 20px;
      text-align: center;
      margin: 0; /* Remove default body margin */
      display: flex;
      flex-direction: column;
      min-height: 100vh; /* Ensure body takes full viewport height */
    }

    h1 {
      color: #1976d2;
      cursor: pointer;
    }

    button {
      background-color: #2196f3;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #1976d2;
    }
    button.remove-btn {
      background-color: #f44336;
    }
    button.remove-btn:hover {
      background-color: #d32f2f;
    }
    button.clear-cart-btn {
      background-color: #ff9800; /* Orange for clear cart */
    }
    button.clear-cart-btn:hover {
      background-color: #fb8c00;
    }

    /* Style for quantity dropdowns */
    .quantity-select {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
      min-width: 80px; /* Adjust width for dropdown */
      text-align: center;
    }
    
    /* Main sections styling */
    #mainSection, #adminLogin, #gallery, #cartSection {
        margin-top: 20px;
        flex-grow: 1; /* Allow sections to take available space */
        display: none; /* Hidden by default, controlled by JS */
        flex-direction: column; /* For consistent layout */
    }
    
    /* Admin login is hidden by default, shown by JS only on title click */
    #adminLogin {
        display: none;
    }


    #cartSection {
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      text-align: right;
    }

    #address {
      margin-top: 10px;
    }
    .image-box {
      background: white;
      padding: 10px;
      border-radius: 10px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      width: calc(50% - 15px); /* Default for 2 items per row with gap */
      box-sizing: border-box; /* Include padding/border in width */
    }

    .image-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
      flex-grow: 1; /* Allow container to grow */
    }

    img {
      width: 100%;
      height: auto; /* Reverted to auto for original aspect ratio */
      border-radius: 8px;
      margin-bottom: 10px;
    }

    select, input[type="password"] {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
      width: calc(100% - 10px); /* Adjust width */
      box-sizing: border-box; /* Include padding/border in width */
    }
    
    .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px dashed #eee;
    }
    .cart-item:last-child {
        border-bottom: none;
    }
    .quantity-control {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .cart-item-info {
        text-align: right;
        flex-grow: 1; /* Allow info section to take available space */
        margin-left: 10px; /* Space between info and controls */
    }
    .cart-item-actions {
        display: flex;
        align-items: center;
    }
    .cart-item-actions span {
        margin-left: 10px;
        font-weight: bold;
    }
    .cart-item-actions button {
      margin-left: 5px;
    }

    /* Controls at the top/bottom of gallery */
    .gallery-controls {
        display: flex;
        justify-content: space-around;
        align-items: center;
        width: 100%;
        padding: 10px 0;
        background-color: #e0e7ff; /* Light background */
        border-top: 1px solid #c3d4e6;
        box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
        z-index: 1000; /* Ensure it's above other content */
    }
    #gallery-bottom-controls {
        margin-top: auto; /* Push to bottom of gallery content */
        position: sticky; /* Make it sticky */
        bottom: 0; /* Stick to the bottom */
        left: 0;
        right: 0;
        border-bottom: none; /* No bottom border for the very bottom one */
    }
    #gallery-top-controls {
        margin-bottom: 10px;
        border-top: none; /* No top border for the very top one */
        box-shadow: 0 2px 5px rgba(0,0,0,0.05); /* Shadow at the bottom */
    }

    .gallery-controls select {
        width: auto;
        flex-grow: 1;
        margin-right: 10px;
    }
    .gallery-controls button {
        margin: 0;
    }
    .in-cart-display {
        font-size: 0.9em;
        color: #007BFF; /* Blue color for in-cart message */
        margin-top: 5px;
        font-weight: bold;
    }

    @media (max-width: 600px) {
        .image-box {
            width: calc(100% - 10px); /* Full width on small screens */
        }
        .gallery-controls {
            flex-direction: column;
            gap: 10px;
        }
        .gallery-controls select, .gallery-controls button {
            width: calc(100% - 20px); /* Full width */
        }
    }
  </style>
</head>
<body>

<h1 onclick="showAdminLogin()">Ù¾ÙˆØ³ØªØ± Ø§ÛŒØ±Ø§Ù†</h1>
<p id="subtitle">Ú†Ø§Ù¾ Ø§Ù†ÙˆØ§Ø¹ Ù¾ÙˆØ³ØªØ±Ù‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</p>

<div id="mainSection">
  <div id="address">
    <p>ØªÙ‡Ø±Ø§Ù† : Ø®ÛŒØ§Ø¨Ø§Ù† Ù¾Ø§Ù†Ø²Ø¯Ù‡ Ø®Ø±Ø¯Ø§Ø¯</p>
    <p>Ø¨Ø§Ø²Ø§Ø± Ø¢Ù‡Ù†Ú¯Ø±Ø§Ù† ØŒ Ú©ÙˆÚ†Ù‡ Ù…Ø³Ø¬Ø¯ Ø¬Ø§Ù…Ø¹</p>
    <p>Ù¾Ø§Ø³Ø§Ú˜ Ú©Ø§ØºØ° Ùˆ ØªØ­Ø±ÛŒØ± ØŒ Ø²ÛŒØ±Ø²Ù…ÛŒÙ† Ø§ÙˆÙ„ - Ù¾Ù„Ø§Ú© 74</p>
    <p>ØªÙ„ÙÙ€Ù†: 02155611875</p>
    <p>Ù…ÙˆØ¨Ø§ÛŒÙ„: 09010195885</p>
  </div>
  <div id="loginSection">
    <button onclick="enterAsUser()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú¯Ø§Ù„Ø±ÛŒ</button>
  </div>
  <div id="adminLogin">
    <input type="password" id="adminPassword" placeholder="Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†">
    <button onclick="loginAsAdmin()">ÙˆØ±ÙˆØ¯ Ø§Ø¯Ù…ÛŒÙ†</button>
  </div>
</div>

<div id="gallery">
  <div id="gallery-top-controls" class="gallery-controls">
    <label>Ø§Ù†ØªØ®Ø§Ø¨ Ú¯Ø±ÙˆÙ‡:</label>
    <select id="topGroupSelect" onchange="changeGroup(this.value)">
      <option value="1">Ø³Ø§ÛŒØ² Û²Û¹Ã—Û²Û± Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
      <option value="2">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
      <option value="3">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
      <option value="4">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
      <option value="5">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÙˆÙˆÛŒâ€ŒØ¯Ø§Ø±</option>
    </select>
    <button onclick="showScreen('cart')">ğŸ›’ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
  </div>
  <div id="imagesContainer" class="image-container"></div>
  <div id="gallery-bottom-controls" class="gallery-controls">
    <label>Ø§Ù†ØªØ®Ø§Ø¨ Ú¯Ø±ÙˆÙ‡:</label>
    <select id="bottomGroupSelect" onchange="changeGroup(this.value)">
      <option value="1">Ø³Ø§ÛŒØ² Û²Û¹Ã—Û²Û± Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
      <option value="2">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
      <option value="3">Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾</option>
      <option value="4">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾</option>
      <option value="5">Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÙˆÙˆÛŒâ€ŒØ¯Ø§Ø±</option>
    </select>
    <button onclick="showScreen('cart')">ğŸ›’ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
  </div>
</div>

<div id="cartSection">
  <h3>ğŸ›’ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</h3>
  <div id="cartList"></div>
  <p id="totalPrice" style="font-weight: bold; font-size: 1.1em; margin-top: 15px;"></p>
  <button onclick="sendOrder()">Ø«Ø¨Øª Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´</button>
  <button onclick="clearCart()" class="clear-cart-btn">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú©Ù„ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
  <button onclick="showScreen('gallery')" style="background-color: #607d8b;">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ú¯Ø§Ù„Ø±ÛŒ</button>
</div>

<script>
const groupInfo = {
  1: {
    name: "Ø³Ø§ÛŒØ² Û²Û¹Ã—Û²Û± Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾",
    count: 22, // ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    price: 100000,
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù†Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    filenames: ["Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", "Ø§Ø¹Ø¯Ø§Ø¯ Ù‡Ù…Ø±Ø§Ù‡ Ø¨Ø§ Ø³Ø§Ø¹Øª Ùˆ Ù…Ø­ÙˆØ±.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø§Ø¹Ø¯Ø§Ø¯.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† ÙˆØ³Ø§Ø¹Øª 2.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„.jpg", "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø§ÙÙ‚ÛŒ).jpg", "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø§ÙˆÙ„ (Ø¹Ù…ÙˆØ¯ÛŒ).jpg", "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø§ÙÙ‚ÛŒ).jpg", "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ø¯ÙˆÙ… (Ø¹Ù…ÙˆØ¯ÛŒ).jpg", "Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ù¾Ø§ÛŒÙ‡ Ø³ÙˆÙ….jpg", /*"Ø­Ø³Ø§Ø¨ Ø¢Ù…ÙˆØ² Ú†Ù‡Ø§Ø±Ù… Ùˆ Ù¾Ù†Ø¬Ù….jpg"*/, "Ø¶Ø±Ø¨ Ùˆ ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨.jpg", /*"Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ… Ø­ÛŒÙˆØ§Ù†Ø§Øª.jpg"*/, "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ.jpg", /*"Ø¢Ù…ÙˆØ²Ø´ Ø¬Ù…Ø¹ Ùˆ ØªÙØ±ÛŒÙ‚.jpg"*/, /*"Ù†Ù‚Ø´Ù‡ Ø§ÛŒØ±Ø§Ù† Ùˆ Ø¬Ù‡Ø§Ù†.jpg"*/, /*"Ø¬Ø¯ÙˆÙ„ ØªÙ‚Ø±ÛŒØ¨ Ø§Ø¹Ø¯Ø§Ø¯.jpg"*/]
  },
  2: {
    name: "Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾",
    count: 4, // ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    price: 100000,
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù†Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    filenames: ["Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 350.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ú©Ø¯ 351.jpg"]
  },
  3: {
    name: "Ø³Ø§ÛŒØ² ÛµÛ°Ã—Û³Ûµ Ø¯ÙˆØ±ÙˆÚ†Ø§Ù¾",
    count: 9, // ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    price: 200000,
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù†Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    filenames: ["Ø§Ø¹Ø¯Ø§Ø¯ Ù‡Ù…Ø±Ø§Ù‡ Ø³Ø§Ø¹Øª Ùˆ Ù…Ø­ÙˆØ±.jpg", "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ùˆ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", "ØªÙ…Ø±ÛŒÙ† Ø¶Ø±Ø¨ Ùˆ ØªÙ‚Ø³ÛŒÙ….jpg", "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹ Ùˆ ØªÙØ±ÛŒÙ‚.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ Ú©Ø§Ù…Ù„.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† Ùˆ Ø³Ø§Ø¹Øª.jpg"]
  },
  4: {
    name: "Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÚ©Ø±ÙˆÚ†Ø§Ù¾",
    count: 12, // ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    price: 200000,
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù†Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    filenames: ["Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ  Ø´Ú©Ù„ Ø¯Ø§Ø±.jpg", "Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ Ø¨Ø¯ÙˆÙ† Ø´Ú©Ù„.jpg", "Ø§Ø¹Ø¯Ø§Ø¯ 1 ØªØ§ 100.jpg", "Ø§Ø¹Ø¯Ø§Ø¯ Ø¯Ù‡ Ø¯Ù‡ÛŒ.jpg", "Ø§Ø¹Ø¯Ø§Ø¯ ÛŒÚ© ØªØ§ Ø¯Ù‡.jpg", "Ø§Ù„ÙØ¨Ø§ÛŒ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¬Ù…Ø¹.jpg", "Ø¬Ø¯ÙˆÙ„ ØªÙØ±ÛŒÙ‚.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨.jpg", "Ø¬Ø¯ÙˆÙ„ ØªÙ‚Ø³ÛŒÙ….jpg", "Ø¬Ø¯ÙˆÙ„ ØªÙ†Ø§ÙˆØ¨ÛŒ Ø¹Ù†Ø§ØµØ±.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ.jpg"]
  },
  5: {
    name: "Ø³Ø§ÛŒØ² Û·Û°Ã—ÛµÛ° ÛŒÙˆÙˆÛŒâ€ŒØ¯Ø§Ø±",
    count: 15, // ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    price: 250000,
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒØ³Øª Ù†Ø§Ù… ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ø¯ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú¯Ø±ÙˆÙ‡
    filenames: ["Ø´Ù‡Ø±Ú© Ø§Ù„ÙØ¨Ø§.jpg", "Ø¬Ø¯ÙˆÙ„ Ø¯ÙˆØ³ØªÛŒ ØªÙ…Ø±ÛŒÙ†ÛŒ.jpg", "Ø¢Ù†Ø§ØªÙˆÙ…ÛŒ Ø¨Ø¯Ù† Ø§Ù†Ø³Ø§Ù†.jpg", "Ø¨Ø¯Ù† Ù…Ù†.jpg", "Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡.jpg", "Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù‡ÙØªÚ¯ÛŒ.jpg", "Ø´Ú©Ù„ ØµØ¯Ø§Ù‡Ø§ Ùˆ Ø§Ù„ÙØ¨Ø§ÛŒ ÙØ§Ø±Ø³ÛŒ.jpg", "Ø¢Ù…ÙˆØ²Ø´ Ø²Ù…Ø§Ù† ÙˆØ³Ø§Ø¹Øª.jpg", "Ø¶Ø±Ø¨ ØªÙ…Ø±ÛŒÙ†ÛŒ Ø³ØªÙˆÙ†ÛŒ.jpg", "Ø¶Ø±Ø¨ ØªÙ…Ø±ÛŒÙ†ÛŒ Ù…Ø±Ø¨Ø¹ÛŒ.jpg", "Ù…Ø­ÛŒØ· Ùˆ Ù…Ø³Ø§Ø­Øª Ø§Ø´Ú©Ø§Ù„ Ù‡Ù†Ø¯Ø³ÛŒ.jpg", "Ù…Ù†Ø¸ÙˆÙ…Ù‡ Ø®ÙˆØ±Ø´ÛŒØ¯ÛŒ.jpg", "Ù†Ù‚Ø´Ù‡ Ø§ÛŒØ±Ø§Ù†.jpg", "Ù†Ù‚Ø´Ù‡ Ø¬Ù‡Ø§Ù†.jpg", /*"Ø¬Ø¯ÙˆÙ„ Ø¶Ø±Ø¨ Ø­ÛŒÙˆØ§Ù†Ø§Øª.jpg"*/]
  },
};

// Quantities must be sorted ascending
const allowedQuantities = [0, 20, 50, 100, 200, 300, 400, 500];
let cart = new Map(JSON.parse(localStorage.getItem('cart') || '[]'));

// --- Screen Management ---
const screens = {
    main: document.getElementById('mainSection'),
    gallery: document.getElementById('gallery'),
    cart: document.getElementById('cartSection')
};

function showScreen(screenName) {
    // Hide all screens
    for (let key in screens) {
        screens[key].style.display = 'none';
    }

    // Show the requested screen
    screens[screenName].style.display = 'flex'; // Use flex for these sections

    // Update history for back button support
    // Only push state if not going back via popstate or already on the screen
    if (history.state === null || history.state.screen !== screenName) {
        history.pushState({ screen: screenName }, '', `#${screenName}`);
    }

    // Specific actions for each screen
    if (screenName === 'gallery') {
        const currentGroupId = document.getElementById('topGroupSelect').value; // Get current selected group
        loadGroup(currentGroupId); // Reload current group
    } else if (screenName === 'cart') {
        renderCartList();
    }
}

// Handle browser's back button
window.addEventListener('popstate', (event) => {
    if (event.state && event.state.screen) {
        // Restore previous screen based on history state
        for (let key in screens) {
            screens[key].style.display = 'none';
        }
        screens[event.state.screen].style.display = 'flex';
        if (event.state.screen === 'gallery') {
            const currentGroupId = document.getElementById('topGroupSelect').value;
            loadGroup(currentGroupId);
        } else if (event.state.screen === 'cart') {
            renderCartList();
        }
    } else {
        // Fallback to main screen if no state (e.g., initial load or direct URL)
        showScreen('main');
    }
});


function enterAsUser() {
  showScreen('gallery');
  // Sync selected group in both dropdowns
  loadGroup(1); // Load the first group by default
}

function showAdminLogin() {
  // Hide initial login button and address/subtitle
  document.getElementById("loginSection").style.display = "none";
  document.getElementById("subtitle").style.display = "none";
  document.getElementById("address").style.display = "none";
  // Show admin login form
  document.getElementById("adminLogin").style.display = "flex";
}

function loginAsAdmin() {
  const pass = document.getElementById("adminPassword").value;
  if (pass === "Alireza55") {
    alert("Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ Ø§Ø¯Ù…ÛŒÙ†!");
    // You might want to navigate to an admin panel or hide this form
    // For now, it just shows an alert
  } else {
    alert("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª");
  }
}

function changeGroup(val) {
  // Sync both dropdowns when one changes
  document.getElementById('topGroupSelect').value = val;
  document.getElementById('bottomGroupSelect').value = val;
  loadGroup(parseInt(val));
}

// Helper to generate options for the quantity dropdown
function generateQuantityOptions(selectedQty) {
    let optionsHtml = '';
    allowedQuantities.forEach(qty => {
        optionsHtml += `<option value="${qty}" ${qty === selectedQty ? 'selected' : ''}>${qty}</option>`;
    });
    return optionsHtml;
}

function loadGroup(groupId) {
  const container = document.getElementById("imagesContainer");
  container.innerHTML = ""; // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØµØ§ÙˆÛŒØ± Ù‚Ø¨Ù„ÛŒ
  const info = groupInfo[groupId];

  // **Ø´Ø±ÙˆØ¹ Ø­Ù„Ù‚Ù‡ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² filenames**
  // Ø§ÛŒÙ† Ø­Ù„Ù‚Ù‡ Ø±ÙˆÛŒ Ù‡Ø± Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ú©Ù‡ Ø¯Ø± Ø¢Ø±Ø§ÛŒÙ‡ filenames ØªØ¹Ø±ÛŒÙ Ø´Ø¯Ù‡ØŒ ÛŒÚ© Ø¨Ø§Ø± ØªÚ©Ø±Ø§Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
  info.filenames.forEach(actualFilename => { // 'actualFilename' Ø­Ø§Ù„Ø§ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø±Ùˆ Ø§Ø² Ø¢Ø±Ø§ÛŒÙ‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ù‡
    
    const imagePath = `Image/${info.name}/${actualFilename}`; // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ù†Ø§Ù… ÙØ§ÛŒÙ„ ÙˆØ§Ù‚Ø¹ÛŒ

    // Ø´Ù†Ø§Ø³Ù‡ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø¢ÛŒØªÙ… Ø±Ùˆ Ù‡Ù… Ø¨Ø§ Ù†Ø§Ù… ÙØ§ÛŒÙ„ ÙˆØ§Ù‚Ø¹ÛŒ Ù…ÛŒâ€ŒØ³Ø§Ø²ÛŒÙ…
    const itemUniqueId = `${groupId}-${actualFilename}`; 
    const currentCartItem = cart.get(itemUniqueId);
    // Ø§Ú¯Ø± Ø¢ÛŒØªÙ… Ø¯Ø± Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø¨ÙˆØ¯ØŒ Ø§Ø² ØªØ¹Ø¯Ø§Ø¯Ø´ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…ØŒ ÙˆÚ¯Ø±Ù†Ù‡ 0
    const initialQty = currentCartItem ? currentCartItem.qty : 0; 

    const box = document.createElement("div");
    box.className = "image-box";

    let inCartMessage = '';
    if (currentCartItem && currentCartItem.qty > 0) {
        inCartMessage = `<p class="in-cart-display">Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: ${currentCartItem.qty} Ø¹Ø¯Ø¯</p>`;
    }

    box.innerHTML = `
      <img src="${imagePath}" alt="Ù¾ÙˆØ³ØªØ± ${info.name} - ${actualFilename}">
      <p style="font-weight: bold; margin-bottom: 5px;">${info.name} - ${actualFilename.replace(/\.jpg$/, '')}</p> 
      <p style="color: #4CAF50; font-weight: bold;">Ù‚ÛŒÙ…Øª: ${info.price.toLocaleString()} Ø±ÛŒØ§Ù„</p>
      <div style="display: flex; align-items: center; margin-top: 10px;">
        <label for="qty-select-${itemUniqueId}">ØªØ¹Ø¯Ø§Ø¯:</label>
        <select id="qty-select-${itemUniqueId}" class="quantity-select">
          ${generateQuantityOptions(initialQty)}
        </select>
        <button onclick="addToCart('${groupId}', '${actualFilename}')">Ø§ÙØ²ÙˆØ¯Ù† Ø¨Ù‡ Ø³Ø¨Ø¯</button>
      </div>
      ${inCartMessage}
    `;
    container.appendChild(box);
  }); // **Ù¾Ø§ÛŒØ§Ù† Ø­Ù„Ù‚Ù‡ forEach**
}

function addToCart(groupId, filename) {
    const info = groupInfo[groupId];
    const itemUniqueId = `${groupId}-${filename}`;
    
    // Get quantity from the select dropdown corresponding to this item
    const qtySelect = document.getElementById(`qty-select-${itemUniqueId}`);
    const selectedQty = parseInt(qtySelect.value);

    if (selectedQty === 0) {
        // If quantity is 0, remove from cart if exists
        if (cart.has(itemUniqueId)) {
            removeFromCart(itemUniqueId); 
            // Update the gallery item's in-cart display after removal
            const inCartDisplayElement = qtySelect.parentNode.parentNode.querySelector('.in-cart-display');
            if (inCartDisplayElement) {
                inCartDisplayElement.remove();
            }
            alert(`"${info.name} - ${filename}" Ø§Ø² Ø³Ø¨Ø¯ Ø­Ø°Ù Ø´Ø¯.`);
        } else {
            alert('Ù„Ø·ÙØ§Ù‹ ØªØ¹Ø¯Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
        }
        return;
    }

    // Always set (override) to ensure "last choice" is recorded
    cart.set(itemUniqueId, {
        groupId: groupId,
        filename: filename,
        groupName: info.name,
        price: info.price,
        qty: selectedQty
    });
    
    saveCart();
    alert(`"${info.name} - ${filename}" Ø¨Ù‡ ØªØ¹Ø¯Ø§Ø¯ ${selectedQty} Ø¹Ø¯Ø¯ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡/Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯.`);

    // Update the in-cart display for the specific item in gallery
    const inCartDisplayElement = qtySelect.parentNode.parentNode.querySelector('.in-cart-display');
    if (inCartDisplayElement) {
        inCartDisplayElement.textContent = `Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: ${selectedQty} Ø¹Ø¯Ø¯`;
    } else {
        const newInCartDisplay = document.createElement('p');
        newInCartDisplay.className = 'in-cart-display';
        newInCartDisplay.textContent = `Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± Ø³Ø¨Ø¯: ${selectedQty} Ø¹Ø¯Ø¯`;
        qtySelect.parentNode.parentNode.appendChild(newInCartDisplay);
    }
}

function updateCartItemQuantityFromDropdown(selectElement, itemUniqueId) {
    let newQty = parseInt(selectElement.value);

    if (isNaN(newQty) || newQty < 0) {
        // This case should ideally not happen with a dropdown of fixed values
        console.error("Invalid quantity selected from dropdown.");
        renderCartList(); // Re-render to revert to last valid quantity
        return;
    }
    
    if (newQty === 0) {
        removeFromCart(itemUniqueId);
    } else {
        let item = cart.get(itemUniqueId);
        item.qty = newQty;
        cart.set(itemUniqueId, item);
        saveCart();
        renderCartList(); // Re-render cart list after update
    }
}

function removeFromCart(itemUniqueId) {
    if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø±Ø§ Ø§Ø² Ø³Ø¨Ø¯ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
        cart.delete(itemUniqueId);
        saveCart();
        renderCartList(); // Re-render cart list after removal
        // Also update the gallery view if currently displayed
        if (document.getElementById('gallery').style.display === 'flex') {
            const qtySelectInGallery = document.getElementById(`qty-select-${itemUniqueId}`);
            if (qtySelectInGallery) {
                qtySelectInGallery.value = 0; // Reset dropdown to 0
                const inCartDisplayElement = qtySelectInGallery.parentNode.parentNode.querySelector('.in-cart-display');
                if (inCartDisplayElement) {
                    inCartDisplayElement.remove(); // Remove the in-cart message
                }
            }
        }
    }
}

function clearCart() {
    if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ú©Ù„ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø±Ø§ Ù¾Ø§Ú© Ú©Ù†ÛŒØ¯ØŸ')) {
        cart.clear(); // Clear all items from the Map
        saveCart(); // Save the empty cart to localStorage
        renderCartList(); // Re-render the cart list to show it's empty
        alert('Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ù¾Ø§Ú© Ø´Ø¯.');
        // Also update the gallery view if currently displayed
        if (document.getElementById('gallery').style.display === 'flex') {
            loadGroup(document.getElementById('topGroupSelect').value); // Reload current group to reset all in-cart messages
        }
    }
}

function renderCartList() {
  const list = document.getElementById("cartList");
  const total = document.getElementById("totalPrice");
  list.innerHTML = ""; // Clear previous list
  let grouped = {};
  let totalSum = 0;

  if (cart.size === 0) {
      list.innerHTML = "<p>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.</p>";
      total.textContent = `Ù…Ø¨Ù„Øº Ú©Ù„: 0 Ø±ÛŒØ§Ù„`;
      return;
  }

  cart.forEach(item => {
    // Group items by their actual groupName for display
    if (!grouped[item.groupName]) grouped[item.groupName] = [];
    grouped[item.groupName].push(item);
    totalSum += item.qty * item.price;
  });

  for (let groupName in grouped) {
    list.innerHTML += `<h4 style="margin-top: 15px; text-align: right; border-bottom: 1px solid #eee; padding-bottom: 5px;">${groupName}</h4>`;
    grouped[groupName].forEach(item => {
      // Correct itemUniqueId for buttons
      const itemUniqueId = `${item.groupId}-${item.filename}`; 
      const itemDiv = document.createElement("div");
      itemDiv.className = "cart-item";
      itemDiv.innerHTML = `
        <div class="cart-item-info">
            <p style="font-weight: bold; margin-bottom: 3px;">${item.groupName} - ${item.filename.replace(/\.jpg$/, '')}</p>

        </div>
        <div class="quantity-control">
          <select id="cart-qty-select-${itemUniqueId}" class="quantity-select" 
                  onchange="updateCartItemQuantityFromDropdown(this, '${itemUniqueId}')">
            ${generateQuantityOptions(item.qty)}
          </select>
          <button class="remove-btn" onclick="removeFromCart('${itemUniqueId}')">Ø­Ø°Ù</button>
        </div>
      `;
      list.appendChild(itemDiv);
    });
  }

  total.textContent = `Ù…Ø¨Ù„Øº Ú©Ù„: ${totalSum.toLocaleString()} Ø±ÛŒØ§Ù„`;
}

function saveCart() {
  localStorage.setItem('cart', JSON.stringify(Array.from(cart.entries())));
}

function sendOrder() {
  if (cart.size === 0) {
    alert('Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª.');
    return;
  }

  let message = "ğŸ›’ Ø³ÙØ§Ø±Ø´ Ø¬Ø¯ÛŒØ¯:\n";
  let totalAmount = 0;
  let groupedOrder = {};

  cart.forEach(item => {
    if (!groupedOrder[item.groupName]) groupedOrder[item.groupName] = [];
    groupedOrder[item.groupName].push(item);
    totalAmount += item.qty * item.price;
  });

  for (let groupName in groupedOrder) {
    message += `\n--- Ú¯Ø±ÙˆÙ‡ ${groupName} ---\n`;
    groupedOrder[groupName].forEach(item => {
      message += `* Ù¾ÙˆØ³ØªØ± ${item.filename.replace(/\.jpg$/, '')} - ØªØ¹Ø¯Ø§Ø¯: ${item.qty}\n`;
    });
  }

  message += `\nğŸ’µ Ù…Ø¨Ù„Øº Ú©Ù„: ${totalAmount.toLocaleString()} Ø±ÛŒØ§Ù„`;
  message += `\n\nÙ„Ø·ÙØ§Ù‹ Ø§ÛŒÙ† Ù¾ÛŒØ§Ù… Ø±Ø§ ØªØºÛŒÛŒØ± Ù†Ø¯Ù‡ÛŒØ¯. Ø¯Ø± Ø§Ø³Ø±Ø¹ ÙˆÙ‚Øª Ø¨Ø§ Ø´Ù…Ø§ ØªÙ…Ø§Ø³ Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.`;

  const phoneNumber = "989010195885"; // Iranian WhatsApp number (with 98 prefix)
  const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;

  window.open(whatsappUrl, '_blank');

  alert('Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ Ø§Ø³Øª.');
}

// Initial load: show main screen and add initial history state
window.onload = function() {
    showScreen('main');
    // Ensure the initial state is also recorded for history API
    history.replaceState({ screen: 'main' }, '', '#main');
    // Load any existing cart items to ensure gallery quantities are correct on load
    renderCartList(); // This also initializes the cart display if empty
};

</script>

</script>
<footer class="mt-auto py-6 text-gray-500 text-sm">
    <p>&copy; Poster Iran 1997</p>
</footer>
<script>
  </script>
<footer class="mt-auto py-6 text-gray-500 text-sm">
    <p> </p>
</footer>
<script>

</body>
</html>
